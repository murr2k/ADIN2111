/* SPDX-License-Identifier: GPL-2.0+ */
/*
 * ADIN2111 Register Definitions
 *
 * Author: Murray Kopit
 * Date: August 11, 2025
 * Copyright (C) 2025 Analog Devices Inc.
 */

#ifndef __ADIN2111_REGS_H__
#define __ADIN2111_REGS_H__

/* SPI Protocol Definitions */
#define ADIN2111_SPI_READ		0x8000
#define ADIN2111_SPI_WRITE		0x0000
#define ADIN2111_SPI_ADDR(x)		((x) & 0x7FFF)

/* System Registers */
#define ADIN2111_IDVER			0x00
#define ADIN2111_IDVER_ID_MASK		GENMASK(31, 16)
#define ADIN2111_IDVER_ID_2111		0x0283
#define ADIN2111_IDVER_REV_MASK	GENMASK(15, 0)

#define ADIN2111_PHYID			0x01
#define ADIN2111_CAPABILITY		0x02
#define ADIN2111_RESET			0x03
#define ADIN2111_RESET_SWRESET		BIT(0)

#define ADIN2111_CONFIG0		0x04
#define ADIN2111_CONFIG0_SYNC		BIT(15)
#define ADIN2111_CONFIG0_TXFCSVE	BIT(14)
#define ADIN2111_CONFIG0_CSARFE		BIT(13)
#define ADIN2111_CONFIG0_ZARFE		BIT(12)
#define ADIN2111_CONFIG0_TXCTE		BIT(11)
#define ADIN2111_CONFIG0_RXCTE		BIT(10)
#define ADIN2111_CONFIG0_FTSE		BIT(9)
#define ADIN2111_CONFIG0_FTSS		BIT(8)
#define ADIN2111_CONFIG0_PROTE		BIT(7)
#define ADIN2111_CONFIG0_SEQE		BIT(6)
#define ADIN2111_CONFIG0_CPS_MASK	GENMASK(2, 0)
#define ADIN2111_CONFIG0_CPS_8		0
#define ADIN2111_CONFIG0_CPS_16	1
#define ADIN2111_CONFIG0_CPS_32	2
#define ADIN2111_CONFIG0_CPS_64	3

#define ADIN2111_CONFIG2		0x06
#define ADIN2111_CONFIG2_MSPEED	BIT(10)
#define ADIN2111_CONFIG2_CRC_APPEND	BIT(5)
#define ADIN2111_CONFIG2_P2_FWD_UNK	BIT(3)
#define ADIN2111_CONFIG2_P1_FWD_UNK	BIT(2)
#define ADIN2111_CONFIG2_PORT_CUT_THRU_EN	BIT(1)

#define ADIN2111_STATUS0		0x08
#define ADIN2111_STATUS0_RESETC	BIT(6)
#define ADIN2111_STATUS0_PHYINT	BIT(7)
#define ADIN2111_STATUS0_TXPE		BIT(0)
#define ADIN2111_STATUS0_TXBOE		BIT(1)
#define ADIN2111_STATUS0_TXBUE		BIT(2)
#define ADIN2111_STATUS0_RXBOE		BIT(3)
#define ADIN2111_STATUS0_RXEVM		BIT(4)
#define ADIN2111_STATUS0_TXFCSE	BIT(5)

#define ADIN2111_STATUS1		0x09
#define ADIN2111_STATUS1_P2_RX_RDY	BIT(17)
#define ADIN2111_STATUS1_P1_RX_RDY	BIT(16)
#define ADIN2111_STATUS1_SPI_ERR	BIT(10)
#define ADIN2111_STATUS1_P2_PHYINT	BIT(7)
#define ADIN2111_STATUS1_P1_PHYINT	BIT(6)
#define ADIN2111_STATUS1_TX_RDY		BIT(3)
#define ADIN2111_STATUS1_RX_RDY		BIT(4)

#define ADIN2111_IMASK0		0x0C
#define ADIN2111_IMASK1		0x0D

#define ADIN2111_CLEAR0		0x0E
#define ADIN2111_CLEAR1		0x0F

/* Buffer Management */
#define ADIN2111_BUFSTS			0x0B
#define ADIN2111_TX_SPACE_MASK		GENMASK(31, 16)
#define ADIN2111_RX_SIZE_MASK		GENMASK(15, 0)

/* MAC Registers */
#define ADIN2111_MAC_ADDR_FILTER_UPR	0x50
#define ADIN2111_MAC_ADDR_FILTER_LWR	0x51
#define ADIN2111_MAC_ADDR_MASK_UPR	0x70
#define ADIN2111_MAC_ADDR_MASK_LWR	0x71

#define ADIN2111_MAC_ADDR_SLOT(n)	(0x50 + (n) * 2)
#define ADIN2111_MAC_ADDR_TO_HOST	BIT(16)
#define ADIN2111_MAC_ADDR_TO_OTHER	BIT(17)
#define ADIN2111_MAC_ADDR_HOST		BIT(30)
#define ADIN2111_MAC_ADDR_APPLY2PORT2	BIT(31)
#define ADIN2111_MAC_ADDR_APPLY2PORT1	BIT(30)

/* TX/RX FIFOs */
#define ADIN2111_TX			0x30
#define ADIN2111_TX_FSIZE		0x31
#define ADIN2111_RX			0x90
#define ADIN2111_RX_FSIZE		0x91

/* MDIO Access Control */
#define ADIN2111_MDIO_ACC		0x20
#define ADIN2111_MDIO_ACC_MDIO_TRCNT	BIT(31)
#define ADIN2111_MDIO_ACC_MDIO_ST	GENMASK(29, 28)
#define ADIN2111_MDIO_ACC_MDIO_OP	GENMASK(27, 26)
#define ADIN2111_MDIO_ACC_MDIO_PRTAD	GENMASK(25, 21)
#define ADIN2111_MDIO_ACC_MDIO_DEVAD	GENMASK(20, 16)
#define ADIN2111_MDIO_ACC_MDIO_DATA	GENMASK(15, 0)

#define ADIN2111_MDIO_ST_CLAUSE_22	0x01
#define ADIN2111_MDIO_OP_READ		0x02
#define ADIN2111_MDIO_OP_WRITE		0x01
#define ADIN2111_MDIO_TIMEOUT_MS	100
#define ADIN2111_RESET_TIMEOUT_MS	1000

/* Frame Size Definitions */
#define ADIN2111_MAX_FRAME_SIZE		1518
#define ADIN2111_FRAME_HEADER_LEN	4
#define ADIN2111_FRAME_HEADER_LEN_MASK	GENMASK(10, 0)
#define ADIN2111_FRAME_HEADER_PORT_MASK	GENMASK(17, 16)

/* TX Space Register */
#define ADIN2111_TX_SPACE		0x32

/* Port Control and Function Registers */
#define ADIN2111_PORT_CTRL		0x33
#define ADIN2111_PORT_FUNCT		0x34
#define ADIN2111_PORT_FUNCT_BC_DIS_P1	BIT(0)
#define ADIN2111_PORT_FUNCT_MC_DIS_P1	BIT(1)
#define ADIN2111_PORT_FUNCT_BC_DIS_P2	BIT(2)
#define ADIN2111_PORT_FUNCT_MC_DIS_P2	BIT(3)

/* FIFO Clear Register */
#define ADIN2111_FIFO_CLR		0x36
#define ADIN2111_FIFO_CLR_TX		BIT(0)
#define ADIN2111_FIFO_CLR_RX		BIT(1)

/* Frame Header Format */
#define ADIN2111_TX_HDR_DNC		BIT(31)
#define ADIN2111_TX_HDR_DV		BIT(30)
#define ADIN2111_TX_HDR_SV		BIT(29)
#define ADIN2111_TX_HDR_PORT_MASK	GENMASK(17, 16)
#define ADIN2111_TX_HDR_VS		BIT(28)

#define ADIN2111_RX_HDR_DNC		BIT(31)
#define ADIN2111_RX_HDR_EV		BIT(23)
#define ADIN2111_RX_HDR_EBO		BIT(22)
#define ADIN2111_RX_HDR_SV		BIT(21)
#define ADIN2111_RX_HDR_PORT_MASK	GENMASK(17, 16)

/* MDIO Registers */
#define ADIN2111_MDIOACC(p)		(0x20 + (p))
#define ADIN2111_MDIO_TRDONE		BIT(31)
#define ADIN2111_MDIO_ST		GENMASK(29, 28)
#define ADIN2111_MDIO_OP		GENMASK(27, 26)
#define ADIN2111_MDIO_OP_RD		0x3
#define ADIN2111_MDIO_OP_WR		0x1
#define ADIN2111_MDIO_PRTAD		GENMASK(25, 21)
#define ADIN2111_MDIO_DEVAD		GENMASK(20, 16)
#define ADIN2111_MDIO_DATA		GENMASK(15, 0)

/* PHY Subsystem Registers */
#define ADIN2111_PHY_SUBSYS_RST	0x3C
#define ADIN2111_PHY_SUBSYS_RST_SOFT	BIT(0)

/* P1/P2 MAC Registers */
#define ADIN2111_P1_MAC_ADDR_FILT_UPR	0x1010
#define ADIN2111_P1_MAC_ADDR_FILT_LWR	0x1011
#define ADIN2111_P2_MAC_ADDR_FILT_UPR	0x1050
#define ADIN2111_P2_MAC_ADDR_FILT_LWR	0x1051

/* P1/P2 RX Registers */
#define ADIN2111_P1_RX			0x1090
#define ADIN2111_P1_RX_FSIZE		0x1091
#define ADIN2111_P2_RX			0x10C0
#define ADIN2111_P2_RX_FSIZE		0x10C1

/* Statistics Registers */
#define ADIN2111_RX_BCAST_CNT		0xA1
#define ADIN2111_RX_MCAST_CNT		0xA2
#define ADIN2111_RX_UCAST_CNT		0xA3
#define ADIN2111_RX_ERR_CNT		0xA4
#define ADIN2111_RX_DROP_CNT		0xA5
#define ADIN2111_RX_BYTE_CNT		0xA6

#define ADIN2111_TX_BCAST_CNT		0xA7
#define ADIN2111_TX_MCAST_CNT		0xA8
#define ADIN2111_TX_UCAST_CNT		0xA9
#define ADIN2111_TX_DROP_CNT		0xAA
#define ADIN2111_TX_BYTE_CNT		0xAB

/* Port Control */
#define ADIN2111_PORT_CTRL(p)		(0x100 + (p) * 0x40)
#define ADIN2111_PORT_CTRL_EN		BIT(0)
#define ADIN2111_PORT_CTRL_FORWARD	BIT(1)
#define ADIN2111_PORT_CTRL_BCAST_DIS	BIT(2)
#define ADIN2111_PORT_CTRL_MCAST_DIS	BIT(3)

/* Constants */
#define ADIN2111_MAX_FRAME_SIZE		1518
#define ADIN2111_MIN_FRAME_SIZE		64
#define ADIN2111_FRAME_HEADER_SIZE	2
#define ADIN2111_FRAME_TRAILER_SIZE	4  /* FCS */
#define ADIN2111_MAX_BUFF		(ADIN2111_MAX_FRAME_SIZE + \
					 ADIN2111_FRAME_HEADER_SIZE + \
					 ADIN2111_FRAME_TRAILER_SIZE)

#define ADIN2111_WR_HEADER_LEN		2
#define ADIN2111_RD_HEADER_LEN		3
#define ADIN2111_REG_LEN		4
#define ADIN2111_ADDR_MASK		GENMASK(11, 0)
#define ADIN2111_CD			BIT(7)
#define ADIN2111_RW			BIT(5)

#define ADIN2111_MAC_FILTER_SLOTS	16
#define ADIN2111_MDIO_TIMEOUT_MS	100
#define ADIN2111_PHY_RESET_DELAY_MS	10
#define ADIN2111_RESET_DELAY_MS		20

#endif /* __ADIN2111_REGS_H__ */